const t="undefined"!=typeof window,e=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),a=t&&"IntersectionObserver"in window,s=t&&"classList"in document.createElement("p"),l=t&&window.devicePixelRatio>1,i={elements_selector:".lazy",container:e||t?document:null,threshold:300,thresholds:null,data_src:"src",data_src_hidpi:"src-hidpi",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1},n=t=>Object.assign({},i,t),r=function(t,e){var a;let s="LazyLoad::Initialized",l=new t(e);try{a=new CustomEvent(s,{detail:{instance:l}})}catch(t){(a=document.createEvent("CustomEvent")).initCustomEvent(s,!1,!1,{instance:l})}window.dispatchEvent(a)},o=(t,e)=>t.getAttribute("data-"+e),c=(t,e,a)=>{var s="data-"+e;null!==a?t.setAttribute(s,a):t.removeAttribute(s)},d=t=>o(t,"ll-status"),_=(t,e)=>c(t,"ll-status",e),u=t=>_(t,null),g=t=>null===d(t),p=t=>"native"===d(t),h=["loading","loaded","applied","error"],b=(t,e,a,s)=>{t&&(void 0===s?void 0===a?t(e):t(e,a):t(e,a,s))},m=(t,e)=>{s?t.classList.add(e):t.className+=(t.className?" ":"")+e},v=(t,e)=>{s?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},E=t=>t.llTempImage,f=(t,e)=>{if(!e)return;const a=e._observer;a&&a.unobserve(t)},I=(t,e)=>{t&&(t.loadingCount+=e)},A=(t,e)=>{t&&(t.toLoadCount=e)},w=t=>{let e=[];for(let a,s=0;a=t.children[s];s+=1)"SOURCE"===a.tagName&&e.push(a);return e},L=(t,e,a)=>{a&&t.setAttribute(e,a)},k=(t,e)=>{t.removeAttribute(e)},z=t=>!!t.llOriginalAttrs,O=t=>{if(z(t))return;const e={};e.src=t.getAttribute("src"),e["src-hidpi"]=t.getAttribute("src-hidpi"),e.srcset=t.getAttribute("srcset"),e.sizes=t.getAttribute("sizes"),t.llOriginalAttrs=e},y=t=>{if(!z(t))return;const e=t.llOriginalAttrs;L(t,"src",e.src),L(t,"src-hidpi",e["src-hidpi"]),L(t,"srcset",e.srcset),L(t,"sizes",e.sizes)},C=(t,e)=>{L(t,"sizes",o(t,e.data_sizes)),L(t,"srcset",o(t,e.data_srcset));const a=o(t,e.data_src),s=o(t,e.data_src_hidpi);L(t,"src",l&&s?s:a)},N=t=>{k(t,"src"),k(t,"src-hidpi"),k(t,"srcset"),k(t,"sizes")},M=(t,e)=>{const a=t.parentNode;a&&"PICTURE"===a.tagName&&w(a).forEach(e)},x=(t,e)=>{w(t).forEach(e)},R={IMG:(t,e)=>{M(t,t=>{O(t),C(t,e)}),O(t),C(t,e)},IFRAME:(t,e)=>{const a=o(t,e.data_src),s=o(t,e.data_src_hidpi);L(t,"src",l&&s?s:a)},VIDEO:(t,e)=>{x(t,t=>{const a=o(t,e.data_src),s=o(t,e.data_src_hidpi);L(t,"src",l&&s?s:a)}),L(t,"poster",o(t,e.data_poster)),L(t,"src",o(t,e.data_src)),t.load()}},G=(t,e)=>{const a=R[t.tagName];a&&a(t,e)},T=(t,e,a)=>{I(a,1),m(t,e.class_loading),_(t,"loading"),b(e.callback_loading,t,a)},D={IMG:(t,e)=>{c(t,e.data_src,null),c(t,e.data_src_hidpi,null),c(t,e.data_srcset,null),c(t,e.data_sizes,null),M(t,t=>{c(t,e.data_srcset,null),c(t,e.data_sizes,null)})},IFRAME:(t,e)=>{c(t,e.data_src,null)},VIDEO:(t,e)=>{c(t,e.data_src,null),c(t,e.data_src_hidpi,null),c(t,e.data_poster,null),x(t,t=>{c(t,e.data_src,null)})}},F=(t,e)=>{c(t,e.data_bg_multi,null),c(t,e.data_bg_multi_hidpi,null)},V=(t,e)=>{const a=D[t.tagName];a?a(t,e):((t,e)=>{c(t,e.data_bg,null),c(t,e.data_bg_hidpi,null)})(t,e)},S=["IMG","IFRAME","VIDEO"],$=(t,e)=>{!e||(t=>t.loadingCount>0)(e)||(t=>t.toLoadCount>0)(e)||b(t.callback_finish,e)},P=(t,e,a)=>{t.addEventListener(e,a),t.llEvLisnrs[e]=a},U=(t,e,a)=>{t.removeEventListener(e,a)},j=t=>!!t.llEvLisnrs,q=t=>{if(!j(t))return;const e=t.llEvLisnrs;for(let a in e){const s=e[a];U(t,a,s)}delete t.llEvLisnrs},H=(t,e,a)=>{(t=>{delete t.llTempImage})(t),I(a,-1),(t=>{t&&(t.toLoadCount-=1)})(a),v(t,e.class_loading),e.unobserve_completed&&f(t,a)},B=(t,e,a)=>{const s=E(t)||t;j(s)||((t,e,a)=>{j(t)||(t.llEvLisnrs={});const s="VIDEO"===t.tagName?"loadeddata":"load";P(t,s,e),P(t,"error",a)})(s,l=>{((t,e,a,s)=>{const l=p(e);H(e,a,s),m(e,a.class_loaded),_(e,"loaded"),V(e,a),b(a.callback_loaded,e,s),l||$(a,s)})(0,t,e,a),q(s)},l=>{((t,e,a,s)=>{const l=p(e);H(e,a,s),m(e,a.class_error),_(e,"error"),b(a.callback_error,e,s),l||$(a,s)})(0,t,e,a),q(s)})},J=(t,e,a)=>{(t=>{t.llTempImage=document.createElement("IMG")})(t),B(t,e,a),((t,e,a)=>{const s=o(t,e.data_bg),i=o(t,e.data_bg_hidpi),n=l&&i?i:s;n&&(t.style.backgroundImage=`url("${n}")`,E(t).setAttribute("src",n),T(t,e,a))})(t,e,a),((t,e,a)=>{const s=o(t,e.data_bg_multi),i=o(t,e.data_bg_multi_hidpi),n=l&&i?i:s;n&&(t.style.backgroundImage=n,((t,e,a)=>{m(t,e.class_applied),_(t,"applied"),F(t,e),e.unobserve_completed&&f(t,e),b(e.callback_applied,t,a)})(t,e,a))})(t,e,a)},K=(t,e,a)=>{(t=>S.indexOf(t.tagName)>-1)(t)?((t,e,a)=>{B(t,e,a),G(t,e),T(t,e,a)})(t,e,a):J(t,e,a)},Q=["IMG","IFRAME"],W=t=>t.use_native&&"loading"in HTMLImageElement.prototype,X=(t,e,a)=>{t.forEach(t=>(t=>t.isIntersecting||t.intersectionRatio>0)(t)?((t,e,a,s)=>{_(t,"entered"),((t,e,a)=>{e.unobserve_entered&&f(t,a)})(t,a,s),b(a.callback_enter,t,e,s),(t=>h.indexOf(d(t))>=0)(t)||K(t,a,s)})(t.target,t,e,a):((t,e,a,s)=>{g(t)||(((t,e,a,s)=>{a.cancel_on_exit&&(t=>"loading"===d(t))(t)&&"IMG"===t.tagName&&(q(t),(t=>{M(t,t=>{N(t)}),N(t)})(t),(t=>{M(t,t=>{y(t)}),y(t)})(t),v(t,a.class_loading),I(s,-1),u(t),b(a.callback_cancel,t,e,s))})(t,e,a,s),b(a.callback_exit,t,e,s))})(t.target,t,e,a))},Y=t=>Array.prototype.slice.call(t),Z=t=>t.container.querySelectorAll(t.elements_selector),tt=t=>(t=>"error"===d(t))(t),et=(t,e)=>(t=>Y(t).filter(g))(t||Z(e)),at=function(e,s){const l=n(e);this._settings=l,this.loadingCount=0,((t,e)=>{a&&!W(t)&&(e._observer=new IntersectionObserver(a=>{X(a,t,e)},(t=>({root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}))(t)))})(l,this),((e,a)=>{t&&window.addEventListener("online",()=>{((t,e)=>{var a;(a=Z(t),Y(a).filter(tt)).forEach(e=>{v(e,t.class_error),u(e)}),e.update()})(e,a)})})(l,this),this.update(s)};at.prototype={update:function(t){const s=this._settings,l=et(t,s);var i,n;A(this,l.length),!e&&a?W(s)?((t,e,a)=>{t.forEach(t=>{-1!==Q.indexOf(t.tagName)&&(t.setAttribute("loading","lazy"),((t,e,a)=>{B(t,e,a),G(t,e),V(t,e),_(t,"native")})(t,e,a))}),A(a,0)})(l,s,this):(n=l,(t=>{t.disconnect()})(i=this._observer),((t,e)=>{e.forEach(e=>{t.observe(e)})})(i,n)):this.loadAll(l)},destroy:function(){this._observer&&this._observer.disconnect(),Z(this._settings).forEach(t=>{delete t.llOriginalAttrs}),delete this._observer,delete this._settings,delete this.loadingCount,delete this.toLoadCount},loadAll:function(t){const e=this._settings;et(t,e).forEach(t=>{f(t,this),K(t,e,this)})}},at.load=(t,e)=>{const a=n(e);K(t,a)},at.resetStatus=t=>{u(t)},t&&((t,e)=>{if(e)if(e.length)for(let a,s=0;a=e[s];s+=1)r(t,a);else r(t,e)})(at,window.lazyLoadOptions);export default at;
